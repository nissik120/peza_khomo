import{u as A,_ as J,a as X}from"./CCYd2_7d.js";import{_ as Y}from"./Bm0Z8KqL.js";import{g as N,c as m,o as p,a as e,b as _,w as U,t as x,n as z,q as w,r as h,d as B,m as s,F as D,p as H,s as Z,H as tt,I as et,J as st,l as R,k as I,v as j,y as nt}from"./BogysZ3r.js";import{_ as ot,a as lt}from"./Bz11v2CG.js";import{u as it}from"./Cd1TOZwt.js";import"./D3BlEqpE.js";import"./C4kIlcjU.js";const rt=["src"],at={class:"p-4"},ut={class:"font-semibold text-gray-800"},dt={class:"text-sm text-gray-500"},mt={class:"text-blue-700 font-semibold mt-2"},pt={class:"text-xs text-gray-400"},ft={class:"flex justify-between items-center mt-3"},ct=["href"],gt=N({__name:"PropertyQueryCard",props:{item:{},parentSlug:{},favorites:{}},emits:["toggleFavorite"],setup(l,{emit:$}){const O=l,u=$;function r(v){u("toggleFavorite",v)}const k=v=>v?`/offer-details/${v.slug}?parent=${O.parentSlug}`:"#";return(v,i)=>{const y=Y;return p(),m("div",{key:l.item.id,class:"bg-white rounded-xl shadow hover:shadow-lg transition overflow-hidden"},[e("img",{src:l.item.images[0],alt:"",class:"h-40 w-full object-cover"},null,8,rt),e("div",at,[_(y,{to:k(l.item)},{default:U(()=>[e("h3",ut,x(l.item.name),1)]),_:1},8,["to"]),e("p",dt,x(l.item.town.name)+", "+x(l.item.town.region),1),e("p",mt,x(l.item.coldRent)+" MWK / month",1),e("p",pt,"Size: "+x(l.item.size)+" m²",1),e("div",ft,[e("a",{href:l.item.googleMapsLink,target:"_blank",class:"text-xs text-blue-500 hover:underline"}," View on Map ",8,ct),e("button",{onClick:i[0]||(i[0]=c=>r(l.item)),class:z(["text-lg",l.favorites.some(c=>c.id===l.item.id)?"text-red-500":"text-gray-400"])}," ♥ ",2)])])])}}}),xt=Object.assign(gt,{__name:"HomePropertyQueryCard"}),vt={class:"py-4 flex flex-row justify-between items-center gap-2"},yt={class:"text-sm text-pottery-light-text dark:text-pottery-dark-text"},bt={class:"grid grid-cols-1 sm:grid-cols-3 md:grid-cols-3 gap-2"},wt=N({__name:"Grid",props:["filteredItemList"],setup(l){const $=l,O=w(()=>$.filteredItemList),u=h(1),r=h(5),k=w(()=>Math.ceil(i.value.length/r.value)),v=w(()=>{const d=(u.value-1)*r.value;return i.value.slice(d,d+r.value)}),i=w(()=>O.value);function y(){u.value<k.value&&u.value++}function c(){u.value>1&&u.value--}return(d,f)=>{const P=ot;return p(),m(D,null,[e("div",vt,[e("p",yt,[f[1]||(f[1]=B(" Showing ",-1)),e("span",null,x(s(u)*s(r)-(s(r)-1)),1),f[2]||(f[2]=B(" to ",-1)),e("span",null,x(s(u)*s(r)>s(i).length?s(i).length:s(u)*s(r)),1),f[3]||(f[3]=B(" (of ",-1)),e("span",null,x(s(i).length),1),f[4]||(f[4]=B(") ",-1))])]),e("div",bt,[(p(!0),m(D,null,H(s(v),(C,V)=>tt(d.$slots,"default",{key:V,item:C})),128))]),_(P,{modelValue:s(r),"onUpdate:modelValue":f[0]||(f[0]=C=>Z(r)?r.value=C:null),currentPage:s(u),totalPages:s(k),onNextPageHandler:y,onPrevPageHandle:c},null,8,["modelValue","currentPage","totalPages"])],64)}}}),_t=Object.assign(wt,{__name:"BaseGrid"}),ht={class:"min-h-screen flex flex-col bg-gray-50 mt-10"},$t={class:"p-4 flex flex-col gap-3"},kt={class:"text-2xl font-bold text-gray-900 flex items-center gap-2"},Pt={class:"flex gap-3 items-center"},Ct={class:"flex flex-1"},Ft={class:"flex justify-between items-center mb-4"},Ot={class:"space-y-4"},St={class:"flex justify-between items-center mb-4"},Mt={class:"space-y-3"},Lt={key:0,class:"text-gray-400 text-sm"},Bt={key:2,class:"container flex-1 p-4"},Rt={key:3,class:"flex-1 p-4"},Wt=N({__name:"[slug]",setup(l){const{offers:$,filteredOffersSearch:O,getOffersBySlug:u,generateSlugByParams:r}=it(),{purposeOptions:k,categoryOptions:v}=A(),i=h(!1),y=h(!1),c=h(!1),d=h([]),P=et().params.slug,C=w(()=>$.value),V=w(()=>$.value.length),T=w(()=>{if(P){u(P.toString());const t=(P?.toString().replace(/^\/offers\//,"")).split("-"),b=t.find(g=>g.startsWith("c="))?.slice(2)||"",S=t.find(g=>g.startsWith("p="))?.slice(2)||"",F=t.find(g=>g.startsWith("l="))?.slice(2)||"";return[b,S,F]}return["","",""]});function Q(o,t,b,S){const F=t?t.split(",").map(K=>K.trim()).join(", "):"",g=b?.trim()||"",L=S?.trim()||"",n=o===1?"offer":"offers",M=[];F&&M.push(`for ${F}`),g&&M.push(`to ${g}`),L&&M.push(`in ${L}`);const W=M.join(" ");return W?`${o} ${n} found ${W}`:`${o} ${n} found`}const a=h({town:T.value[2]??"",minRent:0,maxRent:5e5,type:[],purpose:""}),q=w(()=>{let o=T.value;return Q(V.value,o[0]??"",o[1]??"",a.value.town)});function E(o){d.value.find(b=>b.id===o.id)?d.value=d.value.filter(b=>b.id!==o.id):d.value.push(o)}function G(){if(i.value=!1,a.value.town.length!==0){O(a.value);let o=r(a.value);nt(o)}}return st(()=>{const o=()=>c.value=window.innerWidth<768;o(),window.addEventListener("resize",o)}),(o,t)=>{const b=J,S=X,F=xt,g=_t,L=lt;return p(),m("div",ht,[e("header",$t,[e("h1",kt,x(s(q)),1),e("div",Pt,[e("button",{onClick:t[0]||(t[0]=n=>i.value=!0),class:"md:hidden px-3 py-2 bg-blue-600 text-white rounded-lg text-sm"}," Filters "),e("button",{onClick:t[1]||(t[1]=n=>y.value=!0),class:"px-3 py-2 bg-yellow-500 text-white rounded-lg text-sm"}," Favorites ")])]),e("main",Ct,[e("aside",{class:z(["fixed md:static z-30 md:z-0 bg-white md:w-64 w-80 h-full p-4 border-r transform md:translate-x-0 transition-transform duration-300",{"-translate-x-full":!s(i)&&s(c)}])},[e("div",Ft,[t[11]||(t[11]=e("h2",{class:"font-semibold text-gray-700"},"Filters",-1)),s(c)?(p(),m("button",{key:0,onClick:t[2]||(t[2]=n=>i.value=!1),class:"text-gray-500"},"✕")):R("",!0)]),e("div",Ot,[e("div",null,[t[12]||(t[12]=e("label",{class:"text-sm font-medium text-gray-700"},"Town",-1)),I(e("input",{"onUpdate:modelValue":t[3]||(t[3]=n=>s(a).town=n),type:"text",class:"border w-full rounded p-2 mt-1",placeholder:"Enter town"},null,512),[[j,s(a).town]])]),e("div",null,[t[13]||(t[13]=e("label",null,"Category",-1)),_(b,{multiOptions:s(a).type,"onUpdate:multiOptions":t[4]||(t[4]=n=>s(a).type=n),currentMultiOptions:s(v),multiOptionsPlaceholder:"Select here.."},null,8,["multiOptions","currentMultiOptions"])]),e("div",null,[t[14]||(t[14]=e("label",null,"Purpose",-1)),_(S,{option:s(a).purpose,"onUpdate:option":t[5]||(t[5]=n=>s(a).purpose=n),currentOptions:s(k),optionsPlaceholder:"Select here.."},null,8,["option","currentOptions"])]),e("div",null,[t[15]||(t[15]=e("label",{class:"text-sm font-medium text-gray-700"},"Min Rent (MWK)",-1)),I(e("input",{"onUpdate:modelValue":t[6]||(t[6]=n=>s(a).minRent=n),type:"number",class:"border w-full rounded p-2 mt-1"},null,512),[[j,s(a).minRent,void 0,{number:!0}]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"text-sm font-medium text-gray-700"},"Max Rent (MWK)",-1)),I(e("input",{"onUpdate:modelValue":t[7]||(t[7]=n=>s(a).maxRent=n),type:"number",class:"border w-full rounded p-2 mt-1"},null,512),[[j,s(a).maxRent,void 0,{number:!0}]])]),e("button",{onClick:G,class:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700"}," Apply Filters ")])],2),s(i)&&s(c)?(p(),m("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-40 z-20",onClick:t[8]||(t[8]=n=>i.value=!1)})):R("",!0),e("aside",{class:z(["fixed z-30 bg-white w-80 h-full p-4 border-l transform transition-transform duration-300 right-0",{"translate-x-full":!s(y)}])},[e("div",St,[t[17]||(t[17]=e("h2",{class:"font-semibold text-gray-700"},"Favorites",-1)),e("button",{onClick:t[9]||(t[9]=n=>y.value=!1),class:"text-gray-500"},"✕")]),e("ul",Mt,[(p(!0),m(D,null,H(s(d),n=>(p(),m("li",{key:n.id,class:"text-sm text-gray-600"}," ❤️ "+x(n.name),1))),128)),s(d).length?R("",!0):(p(),m("li",Lt,"No favorites yet"))])],2),s(y)&&s(c)?(p(),m("div",{key:1,class:"fixed inset-0 bg-black bg-opacity-40 z-20",onClick:t[10]||(t[10]=n=>y.value=!1)})):R("",!0),s(C).length!=0?(p(),m("div",Bt,[_(g,{filteredItemList:s(C)},{default:U(({item:n})=>[_(F,{item:n,parentSlug:s(P),onToggleFavorite:M=>E(n),favorites:s(d)},null,8,["item","parentSlug","onToggleFavorite","favorites"])]),_:1},8,["filteredItemList"])])):(p(),m("div",Rt,[_(L)]))])])}}});export{Wt as default};
